<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent System - Enhanced Chat</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; background: #1a1a1a; color: #e0e0e0; height: 100vh; overflow: hidden; }
        .app { display: flex; height: 100vh; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        
        /* Mode-specific themes */
        .app { transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        
        .app.concierge-mode {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a1a2a 100%);
        }
        .app.concierge-mode .sidebar { background: linear-gradient(135deg, #0d0d0d 0%, #1a0d1a 100%); }
        .app.concierge-mode .welcome h1 { background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .app.concierge-mode .new-chat-btn { background: linear-gradient(135deg, #d4af37 0%, #b8860b 100%); }
        
        .app.parallel-mode {
            background: linear-gradient(135deg, #1a1a1a 0%, #1a2a1a 100%);
        }
        .app.parallel-mode .sidebar { background: linear-gradient(135deg, #0d0d0d 0%, #0d1a0d 100%); }
        .app.parallel-mode .welcome h1 { background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .app.parallel-mode .new-chat-btn { background: linear-gradient(135deg, #00ff88 0%, #00aa55 100%); }
        
        .app.sequential-mode {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a1a1a 100%);
        }
        .app.sequential-mode .sidebar { background: linear-gradient(135deg, #0d0d0d 0%, #1a0d0d 100%); }
        .app.sequential-mode .welcome h1 { background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .app.sequential-mode .new-chat-btn { background: linear-gradient(135deg, #ff6b6b 0%, #cc5555 100%); }
        
        .app.loop-mode {
            background: linear-gradient(135deg, #1a1a1a 0%, #1a1a2a 100%);
        }
        .app.loop-mode .sidebar { background: linear-gradient(135deg, #0d0d0d 0%, #0d0d1a 100%); }
        .app.loop-mode .welcome h1 { background: linear-gradient(135deg, #8a2be2 0%, #9932cc 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .app.loop-mode .new-chat-btn { background: linear-gradient(135deg, #8a2be2 0%, #7b68ee 100%); }
        .sidebar { width: 240px; background: #0d0d0d; display: flex; flex-direction: column; padding: 8px; border-right: 1px solid #2a2a2a; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .sidebar.collapsed { width: 45px; }
        .sidebar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .sidebar-icon { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; color: #888; cursor: pointer; border-radius: 6px; transition: all 0.2s ease; font-size: 16px; }
        .sidebar-icon:hover { background: #2a2a2a; color: #fff; transform: scale(1.05); }
        .new-chat-btn { width: 100%; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); border: none; border-radius: 8px; padding: 10px; color: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 13px; margin-bottom: 12px; transition: all 0.2s ease; font-weight: 600; box-shadow: 0 3px 10px rgba(59, 130, 246, 0.3); }
        .new-chat-btn:hover { background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%); transform: translateY(-2px); box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4); }
        .new-chat-btn:active { transform: translateY(0); }
        .chat-history { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 4px; }
        .chat-item { padding: 8px 10px; border-radius: 6px; color: #888; cursor: pointer; font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; transition: all 0.2s ease; animation: slideIn 0.3s ease; }
        .chat-item:hover { background: #2a2a2a; color: #e0e0e0; transform: translateX(4px); }
        .chat-item.active { background: #2a2a2a; color: #e0e0e0; }
        .sidebar.collapsed .new-chat-btn span, .sidebar.collapsed .chat-item { display: none; }
        .main { flex: 1; display: flex; flex-direction: column; position: relative; }
        .mobile-menu-btn { display: none; position: fixed; top: 16px; left: 16px; z-index: 50; width: 40px; height: 40px; background: #2a2a2a; border: 1px solid #3a3a3a; border-radius: 10px; align-items: center; justify-content: center; color: #e0e0e0; font-size: 20px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: all 0.3s ease; animation: scaleIn 0.3s ease; }
        .mobile-menu-btn:hover { background: #333; transform: scale(1.1); }
        .mobile-menu-btn:active { transform: scale(0.95); }
        .welcome { flex: 1; display: flex; flex-direction: column; justify-content: flex-start; align-items: center; padding: 30px 20px; animation: fadeIn 0.5s ease; overflow-y: auto; overflow-x: hidden; }
        .welcome::-webkit-scrollbar { width: 6px; }
        .welcome::-webkit-scrollbar-track { background: transparent; }
        .welcome::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: 3px; }
        .welcome::-webkit-scrollbar-thumb:hover { background: #4a4a4a; }
        .welcome-content { display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 950px; padding-top: 40px; }
        .welcome h1 { font-size: 32px; font-weight: 600; background: linear-gradient(135deg, #8ab4f8 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 8px; letter-spacing: -0.5px; }
        .welcome h2 { font-size: 22px; font-weight: 400; color: #e0e0e0; margin-bottom: 12px; letter-spacing: -0.3px; }
        .welcome p { color: #999; font-size: 14px; margin-bottom: 32px; line-height: 1.5; text-align: center; max-width: 550px; }
        .prompts { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 900px; margin-bottom: 24px; }
        .prompt-card { background: linear-gradient(135deg, #2a2a2a 0%, #252525 100%); border: 1px solid #3a3a3a; border-radius: 10px; padding: 14px; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); min-height: 80px; display: flex; flex-direction: column; justify-content: space-between; position: relative; overflow: hidden; }
        .prompt-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, #8ab4f8, #a78bfa); transform: scaleX(0); transition: transform 0.3s ease; }
        .prompt-card:hover::before { transform: scaleX(1); }
        .prompt-card:hover { background: linear-gradient(135deg, #333 0%, #2a2a2a 100%); border-color: #5a5a5a; transform: translateY(-4px); box-shadow: 0 12px 28px rgba(0,0,0,0.5); }
        .prompt-card p { font-size: 12px; color: #c0c0c0; line-height: 1.4; margin-bottom: 8px; font-weight: 400; }
        .prompt-icon { color: #777; font-size: 16px; }
        .refresh { color: #888; font-size: 12px; cursor: pointer; margin-bottom: 16px; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 5px; padding: 6px 12px; background: #2a2a2a; border-radius: 6px; border: 1px solid #3a3a3a; }
        .refresh:hover { color: #fff; transform: scale(1.05); background: #333; border-color: #4a4a4a; }
        .refresh:active { transform: scale(0.98); }
        .chat-container { flex: 1; overflow-y: auto; padding: 16px 24px; display: none; flex-direction: column; gap: 14px; scroll-behavior: smooth; }
        .chat-container.active { display: flex; }
        .chat-container::-webkit-scrollbar { width: 6px; }
        .chat-container::-webkit-scrollbar-track { background: transparent; }
        .chat-container::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: 3px; }
        .chat-container::-webkit-scrollbar-thumb:hover { background: #4a4a4a; }
        .message { padding: 12px 16px; border-radius: 10px; max-width: 70%; word-wrap: break-word; line-height: 1.5; font-size: 14px; white-space: pre-wrap; animation: fadeIn 0.3s ease; }
        .user { background: linear-gradient(135deg, #2a2a2a 0%, #252525 100%); color: #e8e8e8; align-self: flex-end; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        .assistant { background: transparent; color: #b8b8b8; align-self: flex-start; }
        .input-container { padding: 16px 24px 20px; background: linear-gradient(to top, #1a1a1a 0%, transparent 100%); position: relative; z-index: 10; }
        .input-wrapper { max-width: 900px; margin: 0 auto; background: linear-gradient(135deg, #2a2a2a 0%, #252525 100%); border: 1px solid #3a3a3a; border-radius: 24px; padding: 10px 16px; display: flex; align-items: center; gap: 10px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 3px 12px rgba(0,0,0,0.3); }
        .input-wrapper.focused { border-color: #8ab4f8; box-shadow: 0 0 0 3px rgba(138, 180, 248, 0.15), 0 6px 24px rgba(138, 180, 248, 0.25); background: linear-gradient(135deg, #2d2d2d 0%, #282828 100%); }
        .input-actions { display: flex; gap: 8px; }
        .action-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; background: transparent; border: none; color: #666; cursor: pointer; border-radius: 5px; transition: all 0.2s; font-size: 14px; }
        .action-btn:hover { background: rgba(255,255,255,0.05); color: #fff; }
        input { flex: 1; background: transparent; border: none; outline: none; color: #e8e8e8; font-size: 14px; padding: 2px 0; }
        input::placeholder { color: #666; }
        .send-btn { background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%); color: #000; border: none; border-radius: 8px; padding: 6px 14px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s ease; box-shadow: 0 2px 6px rgba(255,255,255,0.1); }
        .send-btn:hover { background: linear-gradient(135deg, #f0f0f0 0%, #e0e0e0 100%); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(255,255,255,0.15); }
        .send-btn:active { transform: translateY(0); }
        .send-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }
        @media (max-width: 768px) {
            body { height: 100dvh; }
            .app { height: 100dvh; }
            .mobile-menu-btn { display: flex; }
            .sidebar { position: fixed; left: 0; top: 0; height: 100vh; height: 100dvh; z-index: 100; }
            .sidebar.collapsed { transform: translateX(-100%); }
            .sidebar:not(.collapsed) { transform: translateX(0); box-shadow: 4px 0 20px rgba(0,0,0,0.5); }
            .main { width: 100%; height: 100dvh; }
            .welcome { padding-bottom: 100px; }
            .welcome h1 { font-size: 24px; }
            .welcome h2 { font-size: 18px; }
            .welcome p { font-size: 13px; }
            .prompts { grid-template-columns: 1fr; gap: 10px; max-width: 100%; }
            .chat-container { padding: 12px 16px 100px; }
            .message { max-width: 85%; font-size: 13px; }
            .input-container { padding: 12px 16px; position: fixed; bottom: 0; left: 0; right: 0; background: #1a1a1a; border-top: 1px solid #2a2a2a; }
            .input-wrapper { padding: 8px 12px; max-width: 100%; }
            input { font-size: 16px; }
            .send-btn { padding: 6px 12px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-icon" onclick="toggleSidebar()">‚ò∞</div>
            </div>
            <button class="new-chat-btn" onclick="newChat()">
                <span>+</span>
                <span>New Chat</span>
            </button>
            <div class="chat-history" id="chatHistory"></div>
        </div>
        <div class="main">
            <div class="mobile-menu-btn" onclick="toggleSidebar()">‚ò∞</div>
            <div class="welcome" id="welcome">
                <div class="welcome-content">
                    <h1 id="modeTitle">AI Concierge</h1>
                    <h2 id="modeSubtitle">Personal Assistant Service</h2>
                    <p id="modeDescription">Your dedicated personal assistant for daily tasks, scheduling, and information<br>Switch modes in the top-right corner for different AI capabilities</p>
                    <p style="color: #888; font-size: 11px; margin-top: 8px;">Created by Udit Pardeshi & Mrunal Bhavsar</p>
                    <div class="prompts" id="modePrompts">

                    </div>
                    <div class="refresh" onclick="refreshPrompts()" id="refreshBtn">üîÑ Refresh Prompts</div>
                </div>
            </div>
            <div class="chat-container" id="chatContainer"></div>
            <div class="input-container">
                <div class="input-wrapper">
                    <div class="input-actions">
                        <button class="action-btn" title="Save Chat" onclick="saveChatToFile()">üíæ</button>
                        <button class="action-btn" title="Clear Chat" onclick="clearCurrentChat()">üóëÔ∏è</button>
                    </div>
                    <input type="text" id="userInput" placeholder="Ask me anything..." />
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('Multi-Agent System UI v3.0 Loading...');
        
        const API_URL = "";
        const chatContainer = document.getElementById("chatContainer");
        const welcome = document.getElementById("welcome");
        const userInput = document.getElementById("userInput");
        const chatHistory = document.getElementById("chatHistory");
        const inputWrapper = document.querySelector('.input-wrapper');
        let sessionId = "session_" + Date.now();
        let chats = [];
        let currentChatId = null;
        
        // Start with sidebar collapsed by default
        document.getElementById("sidebar").classList.add("collapsed");

        // Core functions
        function saveChatToFile() {
            if (chatContainer.children.length === 0) {
                alert('No conversation to save!');
                return;
            }
            
            const messages = Array.from(chatContainer.children).map(msg => {
                const sender = msg.classList.contains('user') ? 'User' : 'Assistant';
                return `${sender}: ${msg.textContent}`;
            });
            
            const mode = window.currentAgentMode || 'concierge';
            const timestamp = new Date().toLocaleString();
            const content = `Multi-Agent System Chat Export\nMode: ${mode}\nDate: ${timestamp}\nSession: ${sessionId}\n\n${'='.repeat(50)}\n\n${messages.join('\n\n')}\n\n${'='.repeat(50)}\n\nEnd of conversation`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `chat_${mode}_${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show feedback
            const feedback = document.createElement('div');
            feedback.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #27ae60; color: white; padding: 10px 20px; border-radius: 8px; z-index: 2000; font-size: 13px; font-weight: bold; box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);';
            feedback.textContent = '‚úì Chat saved successfully!';
            document.body.appendChild(feedback);
            setTimeout(() => {
                feedback.style.opacity = '0';
                feedback.style.transition = 'opacity 0.3s ease';
                setTimeout(() => feedback.remove(), 300);
            }, 2000);
        }
        
        async function clearCurrentChat() {
            if (confirm('Clear this conversation?')) {
                try {
                    await fetch(`${API_URL}/clear`, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ session_id: sessionId })
                    });
                    chatContainer.innerHTML = "";
                    chatContainer.classList.remove("active");
                    welcome.style.display = "flex";
                } catch (error) {
                    console.error('Error clearing chat:', error);
                }
            }
        }

        function toggleSidebar(e) {
            if (e) e.stopPropagation();
            const sidebar = document.getElementById("sidebar");
            sidebar.classList.toggle("collapsed");
            if (window.innerWidth <= 768 && !sidebar.classList.contains("collapsed")) {
                setTimeout(() => document.addEventListener('click', closeSidebarOnClickOutside), 100);
            } else {
                document.removeEventListener('click', closeSidebarOnClickOutside);
            }
        }

        function closeSidebarOnClickOutside(e) {
            const sidebar = document.getElementById("sidebar");
            const menuBtn = document.querySelector('.mobile-menu-btn');
            if (!sidebar.contains(e.target) && !menuBtn.contains(e.target) && !sidebar.classList.contains("collapsed")) {
                sidebar.classList.add("collapsed");
                document.removeEventListener('click', closeSidebarOnClickOutside);
            }
        }

        function saveChat() {
            if (currentChatId && chatContainer.children.length > 0) {
                const messages = Array.from(chatContainer.children).map(msg => ({
                    text: msg.textContent,
                    sender: msg.classList.contains('user') ? 'user' : 'assistant'
                }));
                const firstMessage = messages[0].text.substring(0, 30);
                const existingChat = chats.find(c => c.id === currentChatId);
                if (existingChat) {
                    existingChat.title = firstMessage;
                    existingChat.messages = messages;
                } else {
                    chats.push({ id: currentChatId, title: firstMessage, sessionId, messages });
                }
                renderChatHistory();
            }
        }

        function renderChatHistory() {
            chatHistory.innerHTML = chats.map(chat => 
                `<div class="chat-item ${chat.id === currentChatId ? 'active' : ''}" onclick="loadChat('${chat.id}')">${chat.title}...</div>`
            ).join('');
        }

        userInput.addEventListener('focus', () => inputWrapper.classList.add('focused'));
        userInput.addEventListener('blur', () => inputWrapper.classList.remove('focused'));

        function newChat() {
            saveChat();
            sessionId = "session_" + Date.now();
            currentChatId = null;
            chatContainer.innerHTML = "";
            chatContainer.classList.remove("active");
            welcome.style.display = "flex";
            userInput.value = "";
            renderChatHistory();
        }

        function loadChat(chatId) {
            saveChat();
            const chat = chats.find(c => c.id === chatId);
            if (chat) {
                currentChatId = chat.id;
                sessionId = chat.sessionId;
                chatContainer.innerHTML = "";
                welcome.style.display = "none";
                chatContainer.classList.add("active");
                if (chat.messages) {
                    chat.messages.forEach((msg, index) => {
                        setTimeout(() => {
                            const div = document.createElement("div");
                            div.className = `message ${msg.sender}`;
                            div.textContent = msg.text;
                            chatContainer.appendChild(div);
                            chatContainer.scrollTop = chatContainer.scrollHeight;
                        }, index * 50);
                    });
                }
                renderChatHistory();
            }
        }

        function usePrompt(text) {
            userInput.value = text;
            sendMessage();
        }

        function addMessage(text, sender) {
            if (!currentChatId) currentChatId = "chat_" + Date.now();
            welcome.style.display = "none";
            chatContainer.classList.add("active");
            const div = document.createElement("div");
            div.className = `message ${sender}`;
            div.textContent = text;
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            if (sender === "assistant") saveChat();
        }

        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            const sendBtn = document.getElementById("sendBtn");
            sendBtn.disabled = true;
            addMessage(text, "user");
            userInput.value = "";

            const loadingDiv = document.createElement("div");
            loadingDiv.className = "message assistant";
            loadingDiv.style.animation = "pulse 1.5s ease-in-out infinite";
            loadingDiv.textContent = "Thinking...";
            chatContainer.appendChild(loadingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            try {
                const response = await fetch(`${API_URL}/chat`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        content: text, 
                        session_id: sessionId,
                        execution_mode: getCurrentMode()
                    })
                });

                const data = await response.json();
                loadingDiv.remove();
                addMessage(data.response, "assistant");
            } catch (error) {
                loadingDiv.remove();
                addMessage("Error connecting to server.", "assistant");
            } finally {
                sendBtn.disabled = false;
                userInput.focus();
            }
        }

        const modeConfigs = {
            concierge: {
                title: 'AI Concierge',
                subtitle: 'Personal Assistant Service',
                description: 'Your dedicated personal assistant for daily tasks, scheduling, and information<br>Switch modes in the top-right corner for different AI capabilities',
                prompts: [
                    { text: 'Help me plan my day and schedule appointments', icon: 'üìÖ' },
                    { text: 'Find restaurants and make dinner reservations', icon: 'üçΩÔ∏è' },
                    { text: 'Book travel arrangements and accommodations', icon: '‚úàÔ∏è' },
                    { text: 'Provide weather updates and outfit recommendations', icon: 'üå§Ô∏è' },
                    { text: 'Search for local events and entertainment options', icon: 'üé≠' },
                    { text: 'Assist with shopping and product recommendations', icon: 'üõçÔ∏è' },
                    { text: 'Help with personal reminders and task management', icon: 'üìù' },
                    { text: 'Provide information and answer general questions', icon: 'üí°' }
                ]
            },
            parallel: {
                title: 'Parallel Agents',
                subtitle: 'Multi-Agent Processing',
                description: 'Multiple AI agents working simultaneously on your requests for faster, comprehensive results<br>Perfect for complex analysis and multi-perspective solutions',
                prompts: [
                    { text: 'Analyze this data from multiple perspectives simultaneously', icon: 'ü§ñ' },
                    { text: 'Compare different approaches to solve this problem', icon: 'üîÑ' },
                    { text: 'Get diverse opinions on this business strategy', icon: 'üìä' },
                    { text: 'Process multiple tasks concurrently for efficiency', icon: '‚ö°' },
                    { text: 'Cross-validate results using different AI models', icon: 'üîç' },
                    { text: 'Generate multiple creative solutions in parallel', icon: 'üé®' },
                    { text: 'Perform simultaneous research on related topics', icon: 'üìö' },
                    { text: 'Execute parallel data processing workflows', icon: 'üöÄ' }
                ]
            },
            sequential: {
                title: 'Sequential Pipeline',
                subtitle: 'Step-by-Step Processing',
                description: 'Agents process your request through structured pipelines for systematic, thorough results<br>Ideal for complex workflows and multi-stage analysis',
                prompts: [
                    { text: 'Research topic ‚Üí Analyze findings ‚Üí Create report', icon: 'üîÑ' },
                    { text: 'Collect data ‚Üí Process information ‚Üí Generate insights', icon: 'üìä' },
                    { text: 'Plan project ‚Üí Execute steps ‚Üí Review outcomes', icon: 'üìÖ' },
                    { text: 'Gather requirements ‚Üí Design solution ‚Üí Implement plan', icon: 'üõ†Ô∏è' },
                    { text: 'Analyze problem ‚Üí Develop strategy ‚Üí Create action plan', icon: 'üéØ' },
                    { text: 'Review content ‚Üí Edit and improve ‚Üí Finalize output', icon: '‚úèÔ∏è' },
                    { text: 'Investigate issue ‚Üí Diagnose cause ‚Üí Propose solution', icon: 'üîç' },
                    { text: 'Brainstorm ideas ‚Üí Evaluate options ‚Üí Select best approach', icon: 'üí°' }
                ]
            },
            loop: {
                title: 'Loop Processing',
                subtitle: 'Iterative Refinement',
                description: 'Continuous improvement through iterative processing until optimal results are achieved<br>Perfect for optimization, refinement, and convergence-based tasks',
                prompts: [
                    { text: 'Optimize this strategy until no further improvements', icon: 'üîÅ' },
                    { text: 'Refine this solution through iterative enhancement', icon: '‚ôæÔ∏è' },
                    { text: 'Improve this content until it reaches quality threshold', icon: 'üéØ' },
                    { text: 'Iterate on this design until convergence is achieved', icon: 'üîÑ' },
                    { text: 'Continuously enhance this algorithm performance', icon: '‚ö°' },
                    { text: 'Perfect this process through repeated refinement', icon: 'üîß' },
                    { text: 'Evolve this idea through multiple iterations', icon: 'üå±' },
                    { text: 'Polish this output until optimal quality is reached', icon: '‚ú®' }
                ]
            }
        };
        
        function refreshPrompts() {
            const mode = window.currentAgentMode || 'concierge';
            updateModeUI(mode);
        }
        
        function updateModeUI(mode) {
            const config = modeConfigs[mode];
            const app = document.querySelector('.app');
            
            // Add fade out effect
            const content = document.querySelector('.welcome-content');
            content.style.opacity = '0';
            content.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                // Update app theme
                app.className = `app ${mode}-mode`;
                
                // Update content
                document.getElementById('modeTitle').textContent = config.title;
                document.getElementById('modeSubtitle').textContent = config.subtitle;
                document.getElementById('modeDescription').innerHTML = config.description;
                
                // Update prompts
                const shuffled = config.prompts.sort(() => 0.5 - Math.random()).slice(0, 4);
                document.getElementById('modePrompts').innerHTML = shuffled.map(prompt => 
                    `<div class="prompt-card" onclick="usePrompt('${prompt.text}')">
                        <p>${prompt.text}</p>
                        <div class="prompt-icon">${prompt.icon}</div>
                    </div>`
                ).join('');
                
                // Fade in effect
                content.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                content.style.opacity = '1';
                content.style.transform = 'translateY(0)';
            }, 300);
        }

        userInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") sendMessage();
        });
        
        function getCurrentMode() {
            const modeMap = {
                'concierge': 'single',
                'parallel': 'parallel', 
                'sequential': 'sequential',
                'loop': 'loop'
            };
            return modeMap[window.currentAgentMode || 'concierge'];
        }
        
        // Initialize UI components
        function initializeUI() {
            console.log('Initializing UI components...');
            
            // Remove any existing components
            document.querySelectorAll('.mode-switcher').forEach(el => el.remove());
            
            // Mode switcher button
            const modeSwitcher = document.createElement('div');
            modeSwitcher.className = 'mode-switcher';
            modeSwitcher.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 1001;';
            
            const switcherBtn = document.createElement('button');
            switcherBtn.style.cssText = 'background: #3498db; color: white; border: none; border-radius: 20px; padding: 8px 12px; font-size: 11px; cursor: pointer; box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3); font-weight: bold;';
            switcherBtn.innerHTML = 'üîÑ Mode';
            
            const switcherPanel = document.createElement('div');
            switcherPanel.style.cssText = 'position: absolute; top: 40px; right: 0; background: #2a2a2a; border: 1px solid #3a3a3a; border-radius: 8px; padding: 8px; min-width: 180px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); display: none;';
            switcherPanel.innerHTML = `
                <div style="color: #e0e0e0; font-size: 11px; font-weight: bold; margin-bottom: 8px;">ü§ñ Agent Mode</div>
                <div class="mode-option" data-mode="concierge" style="padding: 6px 8px; border-radius: 4px; cursor: pointer; font-size: 11px; color: #27ae60; background: #1a3a1a; margin-bottom: 4px;">üé© Concierge Agent</div>
                <div class="mode-option" data-mode="parallel" style="padding: 6px 8px; border-radius: 4px; cursor: pointer; font-size: 11px; color: #b0b0b0; margin-bottom: 4px;">ü§ñ Parallel Agents</div>
                <div class="mode-option" data-mode="sequential" style="padding: 6px 8px; border-radius: 4px; cursor: pointer; font-size: 11px; color: #b0b0b0; margin-bottom: 4px;">üîÑ Sequential Pipeline</div>
                <div class="mode-option" data-mode="loop" style="padding: 6px 8px; border-radius: 4px; cursor: pointer; font-size: 11px; color: #b0b0b0;">üîÅ Loop Processing</div>
            `;
            
            modeSwitcher.appendChild(switcherBtn);
            modeSwitcher.appendChild(switcherPanel);
            document.body.appendChild(modeSwitcher);
            
            // Toggle panel
            switcherBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                switcherPanel.style.display = switcherPanel.style.display === 'none' ? 'block' : 'none';
            });
            
            // Close panel on outside click
            document.addEventListener('click', () => {
                switcherPanel.style.display = 'none';
            });
            
            // Mode selection
            window.currentAgentMode = 'concierge';
            switcherPanel.addEventListener('click', (e) => {
                if (e.target.classList.contains('mode-option')) {
                    const mode = e.target.dataset.mode;
                    window.currentAgentMode = mode;
                    
                    // Update active state
                    switcherPanel.querySelectorAll('.mode-option').forEach(opt => {
                        opt.style.background = 'transparent';
                        opt.style.color = '#b0b0b0';
                    });
                    e.target.style.background = '#1a3a1a';
                    e.target.style.color = '#27ae60';
                    
                    switcherPanel.style.display = 'none';
                    updateModeUI(mode);
                }
            });
            
            // Initialize with concierge mode
            updateModeUI('concierge');
            

            
            console.log('UI components initialized');
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeUI);
        } else {
            initializeUI();
        }
        
        console.log('AI Concierge UI loaded');
    </script>
</body>
</html>